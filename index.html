<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>入出庫送信フォーム</title>
</head>
<body>
<h2>入出庫送信</h2>

<form id="sendForm">
  <label>ID: <input type="text" id="id" required></label><br>
  <label>日付: <input type="date" id="date" required></label><br>
  <label>入庫数: <input type="number" id="inQty"></label><br>
  <label>出庫数: <input type="number" id="outQty"></label><br>
  <label>氏名: <input type="text" id="name" required></label><br>
  <button type="submit">送信</button>
</form>

<script>
const form = document.getElementById("sendForm");

// ページ読み込み時に前回保存した名前を復元
document.addEventListener("DOMContentLoaded", () => {
  const savedName = localStorage.getItem("username");
  if (savedName) {
    document.getElementById("name").value = savedName;
  }
  // 今日の日付を自動セット
  const today = new Date().toISOString().split("T")[0];
  document.getElementById("date").value = today;
});

// 送信イベント
form.addEventListener("submit", async (e) => {
  e.preventDefault();

  const id = document.getElementById("id").value;
  const date = document.getElementById("date").value;
  const inQty = document.getElementById("inQty").value;
  const outQty = document.getElementById("outQty").value;
  const name = document.getElementById("name").value;

  // 名前をローカル保存（次回自動入力用）
  localStorage.setItem("username", name);

  const url = "【GASのWebアプリURL】"
    + "?mode=submit&id=" + encodeURIComponent(id)
    + "&date=" + encodeURIComponent(date)
    + "&inQty=" + encodeURIComponent(inQty)
    + "&outQty=" + encodeURIComponent(outQty)
    + "&name=" + encodeURIComponent(name);

  const res = await fetch(url);
  const result = await res.json();
  alert(result.result === "success" ? "送信しました" : "送信失敗");
});
</script>
</body>
</html>
